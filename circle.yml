deployment:
  staging:
    branch: master
    commands:
      - NODE_ENV=production gulp build
      # - webpack --config scripts/webpack.config.js --profile --json > dist/webpack.json
      - /bin/bash ./scripts/deploy.sh
      - git push git@heroku.com:jspurf.git master
test:
  override:
    - npm test

machine:
  node:
    version: 6.2.0

dependencies:
  pre:
    - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test
    - sudo apt-get install -y gcc-4.9 g++-4.9
    - sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.6 10
    - sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.6 10
    - sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.9 20
    - sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.9 20
    # Circle uses npm v2 by default
    - npm install -g npm@3.x.x
    - sudo apt-get remove openbabel
    - npm install -g gulp babel-core babel-cli webpack
